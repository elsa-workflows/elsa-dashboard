@inject IOptions<LocalizationOptions> LocalizationOptions
@inject IJSRuntime JS
@inject NavigationManager Navigation
@inject ICultureService CultureService

<MudMenu Label="@CultureInfo.CurrentUICulture.NativeName"
         Variant="Variant.Outlined"
         Color="Color.Inherit"
         AnchorOrigin="Origin.BottomRight"
         TransformOrigin="Origin.BottomRight"
         Dense="true"
         StartIcon="@Icons.Material.Filled.Language"
         EndIcon="@Icons.Material.Filled.KeyboardArrowDown">
    @foreach (var culture in cultures)
    {
        <MudMenuItem Value="@culture" OnClick="@((_)=>ChangeCulture(culture))">@culture.NativeName</MudMenuItem>
    }
</MudMenu>

@code {
    private List<CultureInfo> cultures = new List<CultureInfo>();

    protected override void OnInitialized()
    {
        cultures = LocalizationOptions.Value?.SupportedCultures.Select(s => new CultureInfo(s)).ToList() ?? new List<CultureInfo>();
    }

    private async void ChangeCulture(CultureInfo culture)
    {
        await CultureService.ChangeCultureAsync(culture);
    }
}